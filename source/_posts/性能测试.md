---
title: 性能测试
date: 2023-11-20 10:14:14
tags: 测试
---

### 为什么进行性能测试

​		满足真实的业务场景（活动场景），支持大量的用户，满足商用需求。

<!-- more -->

### 什么是性能

​		软件质量属性中的”效率“体现，指时特性与资源特性

### 什么是性能测试

​		使用**自动化工具**，模拟不同的场景，对软件各项性能指标进行测试和评估的过程。（ps:网络也是性能评估的一部分，且只能由工具测试，不能像功能测试一样手动执行）

### 目的

1. 评估当前系统的能力
2. 寻找性能瓶颈，优化性能
3. 评估软件是否能满足未来的需要

## 功能测试与性能测试

​		功能测试：验证软件系统操作功能是否符合产品功能需求规格，主要聚焦在功能（正向、逆向）；

​		性能测试：验证软件系统是否满足业务需求场景，主要聚焦业务场景的满足（时间、资源）；

​		一般项目中，先通过功能测试，后进行性能测试。

## 性能测试策略

### 基准测试

​		狭义：**单用户测试**。测试环境确定后，对业务中的重要业务做单独的测试，获取单用户运行的各项性能指标。（不是指单次测试）

​		广义：在某时刻建立一个已知性能的性能基准线，当**系统软硬件环境**发生变化之后再进行一次基准测试以确定变化对性能的影响。（类似控制变量法）

​		作用：基准测试不会单独存在，为多用户并发测试和综合测试场景提供参考依据，且为系统环境配置，优化前后的性能变化提供参考。

### 负载测试

​		通过**逐步增加系统负载**，确定在**满足系统的性能指标**（如响应时间等）的情况下，找出系统所能承受的**最大负载量**的测试。一般时长为1—2小时。

​		作用：找出系统的最大负载量（也可得到极限负载量），当最大负载量达到需求时，系统才能上线使用。

### 稳定性测试

​		在应用程序**稳定运行**（用户在正常的业务负载下）的情况下进行**长时间测试**（1天—1周），保证**系统长时间稳定运行**。

​		作用：系统在用户要求的业务负载下运行达到相应的时间，才能正式上线使用。

​		注意：只有用户在**正常的业务负载**下才能进行稳定性测试，若用户要求的负载量**大于系统最大负载量**，不能进行稳定性测试。应当进行负载测试，找出性能瓶颈，提升系统最大负载量后再进行稳定性测试。

### 压力测试

​		在**强负载下**的测试，查看系统在**峰值情况**下是否具有**功能隐患**，是否具有良好的**容错能力与可恢复能力**。常用的测试场景有：极限负载情况下导致系统崩溃的**破坏性压力测试**和高负载下的长时间**稳定性压力测试**。

​		注意：破坏性压力测试的负载量为系统的**极限负载量**，即系统即将崩溃。稳定性压力测试的负载量应当**大于系统的最大负载量，小于系统的极限负载量**。

### 并发测试

​		并发测试（绝对并发）：指在**极短的时间**内，发送**多个请求**，验证系统对**并发**的处理能力。与负载测试（相对并发）相区别。特定活动场景如：抢红包、双11秒杀等。

## 性能测试指标

​		一些经过运算得出的结果，来量化衡量某种操作的性能好坏；如：响应时间（RT）。

### 响应时间（RT）

​		指用户从客户端发起一个请求开始，到客户端接收到从服务器端返回的结果，整个过程耗费的时间。即**服务器的处理时间**加**请求/结果的网络传输时间**。

​		注意：不包括发消息时前端页面的处理时间和收到消息后前端页面的渲染显示时间。

### 并发（用户）数

​		某一时刻**同时**向服务器**发起请求**的用户数（请求数）。

### 吞吐量（Throughput)

​		指**单位时间内**处理客户端请求的数量，**直接**体现系统的性能承载能力。

​		QPS：Query Per Second。**每秒查询数**，即服务器每秒处理的指定请求（查询请求）的数量。

​		TPS：Transactions Per Second。**每秒事务数**，即服务器每秒处理的事务请求的数量。 事务：即对应的一次业务操作，可能包含多个请求。一般由测试人员定义事务的大小。当一个事务对应一个请求时，TPS=QPS。

### 点击数

​		指客户端向服务端发送请求时，**所有的页面资源元素**（图片，链接，css，js等）的请求总量。

​		注意：只有web项目才有此指标；且点击数不是页面上的一次点击，而是这次点击所发出的总的请求数。

### 错误率

​		指系统在**负载情况**下，失败业务的概率。即错误率=（失败业务/业务总数）*100%。大多数系统都会要求错误率无限接近于0；错误率是一个性能指标，不是功能上的随机bug。先解决随机功能bug才能进行性能测试。

​		注意：只有在负载情况下的失败才是性能上的问题，才能统计错误率，否则只能是功能上的随机bug。

​		例如，一个用户发起10次请求，成功8次，错误2次，这只能说明出现了随机功能bug。因为没有具体的负载业务场景。

### 资源使用率

​		系统各种资源的使用情况，**一般**资源使用率=（资源使用量/资源总量）*100%。对于cpu与内存，指代的是使用的cpu与内存的百分比；而对于磁盘IO与网络，指的是读取写入速度的百分比与网络传输速度的百分比。

## 性能测试的流程

### 性能测试需求分析

​		熟悉需求，获取性能需求指标。

​		明确被测系统（业务功能、架构）—明确测试内容（高频业务/逻辑复杂业务、数据量大业务）—明确测试策略（负载、稳定...)—明确测试指标（预期指标对比/预估指标）

### 性能测试的计划和方案

​		WWW方案。What、Who、How。

### 性能测试用例

​		用例名称、用例编号、用例描述、前置条件、用例步骤、期望性能结果、实际结果。

### 性能测试执行

​		建立测试环境—编写测试脚本—性能测试监控—执行测试脚本。

### 性能分析与调优

​		性能测试分析人员根据对结果的分析，如果不符合性能需求，则提出性能bug，由开发人员进行后续的调优。而后继续进行性能验证，直到满足性能需求为止。

### 性能测试报告总结

- 测试工作的回顾
- 缺陷分析和调优
- 风险评估
- 性能测试结果
- 总结与该进





​		关于性能测试需求分析，描述正确的是:（ACD）
A、性能测试需求分析时，需要对系统的业务功能非常熟悉

B、性能测试需求分析时，可以不用关心系统的技术实现

C、有明确需求指标时，性能测试的指标完全根据需求来确定

D、没有明确的需求指标时，性能测试的指标根据经验来确定

ps：需要关心系统的技术实现，不同的环境、操作系统、资源对系统的性能影响。

​		关于性能测试环境，描述正确的是: （AD）

A、性能测试环境和功能测试环境一样，需要使用指定的软件及版本

B、性能测试环境和功能测试环境一样，可以多个测试人员一起使用

C、性能测试环境和功能测试环境一样，可以把软件都安装在一台服务器上，只需要保证环境可以正常访问即可

D、性能测试环境可以找运维和开发协助搭建

ps：多个测试人员一起使用就瓜分了系统资源了，判断不出具体的系统时间，空间特性；要保证测试环境与真实环境一致，测试才有意义。

​		关于性能测试执行，描述正确的是: （ABC）

A、性能测试脚本执行前，必须保证所有的脚本都调试通过了

B、性能测试脚本执行前，还需要设置脚本运行的场景〔并发数、运行时间、启动方式等等)

C、性能测试脚本执行时，需要同步监控服务器的各项性能指标

D、服务器的各项性能指标，可以在性能测试结束后再统一收集

ps：性能指标需要同步收集，最后只能收集到状态或小部分指标，不够全面准确。

​		关于性能测试分析和调优，描述正确的是:（AD）
A、测试人员需要对性能测试结果进行分析，如果有问题则提交bug

B、测试人员需要对性能测试的问题进行调优，找到问题的原因，并给出解决建议

C、经验丰富的性能调优人员，通常能准确的定位出性能的根本原因，一次就能修改成功

D、性能调优后，需要测试对比是否有性能提升;通常性能调优要经过很多轮的优化才能最终达成性能指标

ps：调优是开发的工作。
